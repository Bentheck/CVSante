@* @model IEnumerable<CVSante.ViewModels.User>

@{
    ViewData["Title"] = "Formulaire d'Informations";
}

<div class="form-container">
    <h2>Formulaire d'Informations</h2>

    <div class="form-navigation-container">
        <label for="stepSelector">Sélectionner les différentes sections :</label>
        <select id="stepSelector" onchange="onStepChanged(this.value)">
            <option value="1">Localisation</option>
            <option value="2">Informations Personnelles</option>
            <option value="3">Allergies/Intolérances alimentaires</option>
            <option value="4">Antécédents médicaux</option>
            <option value="5">Médication</option>
        </select>
    </div>


    <form id="mainForm" method="post" action="@Url.Action("SubmitForm", "Home")">
        <div id="formStep">
            @{
                Html.RenderPartial("FormLocalisation", Model.UserAdresse);
            }
        </div>

        <div class="form-navigation">
            <button id="prevButton" type="button" onclick="prevStep()" style="display: none;">Précédent</button>
            <button id="nextButton" type="button" onclick="nextStep()">Suivant</button>
            <button id="submitButton" type="submit" style="display: none;">Soumettre</button>
        </div>
    </form>
</div>

@section Scripts {
    <script>
        let step = 1;

        function onStepChanged(value) {
            step = parseInt(value);
            loadStep();
        }

        function nextStep() {
            if (step < 5) {
                step++;
                loadStep();
            }
        }

        function prevStep() {
            if (step > 1) {
                step--;
                loadStep();
            }
        }

        function loadStep() {
            const formStep = document.getElementById('formStep');
            let url = '';

            switch (step) {
                case 1: url = '@Url.Action("FormLocalisation", "Home")'; break;
                case 2: url = '@Url.Action("FormInfoPers", "Home")'; break;
                case 3: url = '@Url.Action("FormAllergiesIntolerances", "Home")'; break;
                case 4: url = '@Url.Action("FormAntecedentsMedicaux", "Home")'; break;
                case 5: url = '@Url.Action("FormMedication", "Home")'; break;
            }

            fetch(url)
                .then(response => response.text())
                .then(html => {
                    formStep.innerHTML = html;
                    document.getElementById('prevButton').style.display = step > 1 ? 'inline-block' : 'none';
                    document.getElementById('nextButton').style.display = step < 5 ? 'inline-block' : 'none';
                    document.getElementById('submitButton').style.display = step === 5 ? 'inline-block' : 'none';
                });
        }

       

        document.addEventListener('DOMContentLoaded', loadStep);
    </script>
} *@